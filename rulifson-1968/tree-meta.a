  NOLIST NUL,EXT;GEN OPD 101B5,1,1;BF OPD 102B5,1,1
BT OPD 103B5,1,1;PSHN OPD 104B5,1,1;PSHK OPD 105B5,1,1
MKND OPD 106B5,1,1;NDLBL OPD 107B5,1,1;GET OPD 110B5,1,1
BPTR OPD 111B5,1,1;BNPTR OPD 112B5,1,1;RI1 OPD 113B5,1,1
RI2 OPD 114B5,2;FLGT OPD 115B5,1,1;BE OPD 116B5,1,1
LAB OPD 117B5,1,1;CE OPD 120B5,1,1;LDKA OPD 121B5,1,1
$KSTKSZ EQU 100;$MSTKSZ EQU 130;$NSTKSZ EQU 1300;$SSTKSZ EQU 1400
$START BRM INITL; CLA; STA WRK; STA XWRK
  BRM RLINE; BRM PROGRAM; BRM FINISH
PROGRAM ZRO; LDA *-1; BRM CLLO
  BRM TST; DATA .META0; ASC '.META'
  BF 2
  BRM ID; BF *+3; MRG IDFLG; PSHK =0
  LDA =1
  BE 0
  BRM TST; DATA .LIST0; ASC '.LIST'
  BF 4
  NDLBL =LIST
  MKND =0
  BRU 5
3 EQU *
  LDA =1; STA MFLAG
  BF 6
  NDLBL =MT
  MKND =0
6 EQU *
5 EQU *
  BE =-1
  BRM SIZE
  BE =-1
  NDLBL =BEGIN
  MKND =3
  BRU 7
1 EQU *
  BRM TST; DATA .CONTINUE0; ASC '.CONTINUE'
  BF 8
  NDLBL =MT
  MKND =0
8 EQU *
7 EQU *
  BF 9
  LDA =1; STA FNUMO
  LDA TCHNO; XMA CHNO; STA TCHNO
  BRM LIT;  DATA TREE 1.30; ASC 'TREE 1.3'
  LDA XFNUMO; STA FNUMO
  BRM SETUP
  BE =-1
  MKND =1
BBM OUTREE; BT *+3; LDA =2; BRM CERR
10  EQU *
  BRM RULE
  BF 11
BBM OUTREE; BT *+3; LDA =2; BRM CERR
11  EQU *
  BT 10; MIN MFLAG
  BE =-1
  BRM TST; DATA .END0; ASC '.END'
  LDA =2
  BE E
  NDLBL =ENDN
  MKND =0
BBM OUTREE; BT *+3; LDA =2; BRM CERR
9 EQU *
  BRU RTNO
SIZE  ZRO; LDA *-1; BRM CLLO
  LDA =40; BRM TCH
  BF 13
  BRM SIZ
  BE =-1
14  EQU *
  LDA =44; BRM TCH
  BF 15
  BRM SIZ
  BE =-1
  NDLBL =DO
  MKND =2
15  EQU *
  BT 14; MIN MFLAG
  BE =-1
  LDA =41; BRM TCH
  LDA =50
  BE E
  BRU 16
12  EQU *
  LDA =1; STA MFLAG
  BF 17
  NDLBL =MT
  MKND =0
17  EQU *
16  EQU *
  BRU RTNO
SIZ ZRO; LDA *-1; BRM CLLO
  BRM WPREP; BRM INC; LDA* IWP; MRG CHRFLG; MIN NCCP; PSHK =0
  BF 18
  LDA =61; BRM TCH
  LDA =54
  BE E
  BRM NUM; BF *+3; MRG NUMFLG; PSHK =0
  LDA =55
  BE E
  NDLBL =SIZS
  MKND =2
18  EQU *
  BRU RTNO
RULE  ZRO; LDA *-1; BRM CLLO
  BRM ID; BF *+3; MRG IDFLG; PSHK =0
  BF 19
  LDA =61; BRM TCH
  BF 21
  BRM EXP
  LDA =3
  BE E
  LDA =37; BRM TCH
  BF 22
  NDLBL =KPOPK
  MKND =1
22  EQU *
  LDA =1; STA MFLAG
  NDLBL =OUTPT
  MKND =2
  BRU 23
20  EQU *
  LDA =47; BRM TCH
  BF 25
  BRM TST; DATA =>0; ASC '=>'
  LDA =3
  BE E
  BRM GEN1
  BE =-1
  NDLBL =SIMP
  MKND =2
  BRU 26
24  EQU *
  BRM OUTRUL
  BF 27
  NDLBL =OUTPT
  MKND =2
27  EQU *
26  EQU *
23  EQU *
  LDA =5
  BE E
  LDA =59; BRM TCH
  LDA =6
  BE E
19  EQU *
  BRU RTNO
EXP ZRO; LDA *-1; BRM CLLO
  BRM TST; DATA <-0; ASC '<-'
  BF 29
  BRM SUBACK
  LDA =7
  BE E
  LDA =47; BRM TCH
  BF 31
  BRM EXP
  LDA =8
  BE E
  NDLBL =BALTER
  MKND =2
  BRU 32
30  EQU *
  LDA =1; STA MFLAG
  BF 33
  NDLBL =BALTER
  MKND =1
33  EQU *
32  EQU *
  BE =-1
  BRU 34
28  EQU *
  BRM SUBEXP
  BF 35
  LDA =47; BRM TCH
  BF 36
  BRM EXP
  LDA =9
  BE E
  NDLBL =ALTER
  MKND =2
36  EQU *
  LDA =1; STA MFLAG
35  EQU *
34  EQU *
  BRU RTNO
SUBACK  ZRO; LDA *-1; BRM CLLO
  BRM NTEST
  BF 38
  BRM SUBACK
  BF 39
  NDLBL =DO
  MKND =2
39  EQU *
  LDA =1; STA MFLAG
  BRU 40
37  EQU *
  BRM STEST
  BF 41
  BRM SUBACK
  BF 42
  NDLBL =CONCAT
  MKND =2
42  EQU *
  LDA =1; STA MFLAG
41  EQU *
40  EQU *
  BRU RTNO
SUBEXP  ZRO; LDA *-1; BRM CLLO
  BRM NTEST
  BT 43
  BRM STEST
43  EQU *
  BF 44
  BRM NOBACK
  BF 45
  NDLBL =CONCAT
  MKND =2
45  EQU *
  LDA =1; STA MFLAG
44  EQU *
  BRU RTNO
NOBACK  ZRO; LDA *-1; BRM CLLO
  BRM NTEST
  BT 46
  BRM STEST
  BF 47
  LDA =63; BRM TCH
  BF 49
  BRM NUM; BF *+3; MRG NUMFLG; PSHK =0
  LDA =10
  BE E
  NDLBL =LOAD
  MKND =1
  BRM ID; BF *+3; MRG IDFLG; PSHK =0
  BT 50
  LDA =63; BRM TCH
  BF 51
  NDLBL =ZRO
  MKND =0
51  EQU *
50  EQU *
  LDA =11
  BE E
  NDLBL =ERCOD
  MKND =3
  BRU 52
48  EQU *
  LDA =1; STA MFLAG
  BF 53
  NDLBL =ER
  MKND =1
53  EQU *
52  EQU *
  BE =-1
47  EQU *
46  EQU *
  BF 54
  BRM NOBACK
  BF 55
  NDLBL =DO
  MKND =2
55  EQU *
  LDA =1; STA MFLAG
54  EQU *
  BRU RTNO
NTEST ZRO; LDA *-1; BRM CLLO
  LDA =58; BRM TCH
  BF 57
  BRM ID; BF *+3; MRG IDFLG; PSHK =0
  LDA =12
  BE E
  NDLBL =NDLB
  MKND =1
  BRU 58
56  EQU *
  LDA =91; BRM TCH
  BF 60
  BRM NUM; BF 61; MRG NUMFLG; PSHK =0
  LDA =93; BRM TCH
  LDA =14
  BE E
  NDLBL =MKNODE
  MKND =1
  BRU 62
61  EQU *
  BRM GENP
  BF 63
  LDA =93; BRM TCH
  LDA =52
  BE E
  LDA =58; BRM TCH
  BT 64
  LDA =1; STA MFLAG
  BF 65
  NDLBL =OUTCH
  MKND =0
  NDLBL =DO
  MKND =2
65  EQU *
64  EQU *
  BE =-1
63  EQU *
62  EQU *
  BE =-1
  BRU 66
59  EQU *
  LDA =60; BRM TCH
  BF 68
  BRM GENP
  BE =-1
  LDA =62; BRM TCH
  LDA =53
  BE E
  LDA =58; BRM TCH
  BT 69
  LDA =1; STA MFLAG
  BF 70
  NDLBL =OUTCH
  MKND =0
  NDLBL =DO
  MKND =2
70  EQU *
69  EQU *
  BE =-1
  NDLBL =TTY
  MKND =1
  BRU 71
67  EQU *
  BRM TST; DATA .CHR0; ASC '.CHR'
  BF 74
  NDLBL =GCHR
  BRU 75
73  EQU *
  LDA =42; BRM TCH
  BF 76
  NDLBL =GO
76  EQU *
75  EQU *
  BF 77
  MKND =0
  BRU 78
72  EQU *
  BRM TST; DATA =>0; ASC '=>'
  BF 80
  BRM STEST
  LDA =15
  BE E
  NDLBL =SCAN
  MKND =1
  BRU 81
79  EQU *
  BRM COMM
81  EQU *
78  EQU *
71  EQU *
66  EQU *
58  EQU *
  BRU RTNO
GENP  ZRO; LDA *-1; BRM CLLO
  BRM GENP1
  BT 82
  LDA =1; STA MFLAG
  BF 83
  NDLBL =MT
  MKND =0
83  EQU *
82  EQU *
  BRU RTNO
GENP1 ZRO; LDA *-1; BRM CLLO
  BRM GENP2
  BF 84
  BRM GENP1
  BF 85
  NDLBL =DO
  MKND =2
85  EQU *
  LDA =1; STA MFLAG
84  EQU *
  BRU RTNO
GENP2 ZRO; LDA *-1; BRM CLLO
  LDA =42; BRM TCH
  BF 87
  LDA =83; BRM TCH
  BF 89
  BRM NUM; BF *+3; MRG NUMFLG; PSHK =0
  LDA =51
  BE E
  NDLBL =PAROUT
  MKND =1
  BRU 90
88  EQU *
  LDA =1; STA MFLAG
  BF 91
  NDLBL =ZRO
  MKND =0
  NDLBL =PAROUT
  MKND =1
91  EQU *
90  EQU *
  BE =-1
  LDA =76; BRM TCH
  BF 93
  NDLBL =OL
  BRU 94
92  EQU *
  LDA =67; BRM TCH
  BF 96
  NDLBL =OC
  BRU 97
95  EQU *
  LDA =78; BRM TCH
  BF 99
  NDLBL =ON
  BRU 100
98  EQU *
  LDA =1; STA MFLAG
  BF 101
  NDLBL =OS
101 EQU *
100 EQU *
97  EQU *
94  EQU *
  BE =-1
  MKND =0
  NDLBL =NOPT
  MKND =2
  BRU 102
86  EQU *
  BRM GENU
102 EQU *
  BRU RTNO
COMM  ZRO; LDA *-1; BRM CLLO
  BRM TST; DATA .EMPTY0; ASC '.EMPTY'
  BF 104
  NDLBL =SET
  MKND =0
  BRU 105
103 EQU *
  LDA =33; BRM TCH
  BF 106
  BRM SR; BF *+3; MRG SRFLG; PSHK =0
  LDA =18
  BE E
  NDLBL =IMED
  MKND =1
106 EQU *
105 EQU *
  BRU RTNO
STEST ZRO; LDA *-1; BRM CLLO
  LDA =46; BRM TCH
  BF 108
  BRM ID; BF *+3; MRG IDFLG; PSHK =0
  LDA =19
  BE E
  NDLBL =PRIM
  MKND =1
  BRU 109
107 EQU *
  BRM ID; BF 110; MRG IDFLG; PSHK =0
  NDLBL =CALL
  MKND =1
  BRU 111
110 EQU *
  BRM SR; BF 112; MRG SRFLG; PSHK =0
  NDLBL =STST
  MKND =1
  BRU 113
112 EQU *
  LDA =40; BRM TCH
  BF 115
  BRM EXP
  LDA =20
  BE E
  LDA =41; BRM TCH
  LDA =21
  BE E
  BRU 116
114 EQU *
  LDA =39; BRM TCH
  BF 118
  BRM WPREP; BRM INC; LDA* IWP; MRG CHRFLG; MIN NCCP; PSHK =0
  NDLBL =CTST
  MKND =1
  BRU 119
117 EQU *
  BRM NUM; BF 121; MRG NUMFLG; PSHK =0
  LDA =36; BRM TCH
  LDA =23
  BE E
  BRU 122
121 EQU *
  LDA =36; BRM TCH
  BF 123
  NDLBL =ZRO
  MKND =0
123 EQU *
122 EQU *
  BF 124
  BRM NUM; BF *+3; MRG NUMFLG; PSHK =0
  BT 125
  LDA =1; STA MFLAG
  BF 126
  NDLBL =MT
  MKND =0
126 EQU *
125 EQU *
  BE =-1
  BRM STEST
  LDA =20
  BE E
  NDLBL =ARB
  MKND =3
  BRU 127
120 EQU *
  LDA =45; BRM TCH
  BF 128
  BRM SR; BF 129; MRG SRFLG; PSHK =0
  NDLBL =NSR
  MKND =1
  BRU 130
129 EQU *
  LDA =39; BRM TCH
  BF 131
  BRM WPREP; BRM INC; LDA* IWP; MRG CHRFLG; MIN NCCP; PSHK =0
  NDLBL =NCHR
  MKND =1
131 EQU *
130 EQU *
  LDA =26
  BE E
  NDLBL =NTST
  MKND =1
128 EQU *
127 EQU *
119 EQU *
116 EQU *
113 EQU *
111 EQU *
109 EQU *
  BRU RTNO
OUTRUL  ZRO; LDA *-1; BRM CLLO
  LDA =91; BRM TCH
  BF 132
  BRM OUTR
  LDA =27
  BE E
  BRM OUTRUL
  BF 133
  NDLBL =ALTER
  MKND =2
133 EQU *
  LDA =1; STA MFLAG
  NDLBL =OSET
  MKND =1
132 EQU *
  BRU RTNO
OUTR  ZRO; LDA *-1; BRM CLLO
  BRM OUTEST
  BF 134
  BRM TST; DATA =>0; ASC '=>'
  LDA =29
  BE E
  BRM OUTEXP
  LDA =30
  BE E
  NDLBL =CONCAT
  MKND =2
134 EQU *
  BRU RTNO
OUTEST  ZRO; LDA *-1; BRM CLLO
  LDA =93; BRM TCH
  BF 137
  NDLBL =MT
  BRU 138
136 EQU *
  BRM TST; DATA -]0; ASC '-]'
  BF 140
  NDLBL =ONE
  BRU 141
139 EQU *
  BRM TST; DATA -,-]0; ASC '-,-]'
  BF 143
  NDLBL =TWO
  BRU 144
142 EQU *
  BRM TST; DATA -,-,-]0; ASC '-,-,-]'
  BF 145
  NDLBL =THRE
145 EQU *
144 EQU *
141 EQU *
138 EQU *
  BF 146
  MKND =0
  BRU 147
135 EQU *
  BRM ITEMS
  BF 148
  LDA =93; BRM TCH
  BE =-1
148 EQU *
147 EQU *
  BF 149
  NDLBL =CNTCK
  MKND =1
149 EQU *
  BRU RTNO
ITEMS ZRO; LDA *-1; BRM CLLO
  BRM ITEM
  BF 150
  LDA =44; BRM TCH
  BF 152
  BRM ITEMS
  LDA =32
  BE E
  NDLBL =ITMSTR
  MKND =2
  BRU 153
151 EQU *
  LDA =1; STA MFLAG
  BF 154
  NDLBL =LITEM
  MKND =1
154 EQU *
153 EQU *
  BE =-1
150 EQU *
  BRU RTNO
ITEM  ZRO; LDA *-1; BRM CLLO
  LDA =45; BRM TCH
  BF 156
  NDLBL =MT
  MKND =0
  BRU 157
155 EQU *
  BRM ID; BF 158; MRG IDFLG; PSHK =0
  LDA =91; BRM TCH
  LDA =33
  BE E
  BRM OUTEST
  LDA =34
  BE E
  NDLBL =RITEM
  MKND =2
  BRU 159
158 EQU *
  BRM NSIMP1
  BF 161
  NDLBL =NITEM
  MKND =1
  BRU 162
160 EQU *
  LDA =46; BRM TCH
  BF 164
  BRM ID; BF *+3; MRG IDFLG; PSHK =0
  LDA =35
  BE E
  NDLBL =FITEM
  MKND =1
  BRU 165
163 EQU *
  BRM SR; BF 166; MRG SRFLG; PSHK =0
  NDLBL =TTST
  MKND =1
  BRU 167
166 EQU *
  LDA =39; BRM TCH
  BF 169
  BRM WPREP; BRM INC; LDA* IWP; MRG CHRFLG; MIN NCCP; PSHK =0
  NDLBL =CHTST
  MKND =1
  BRU 170
168 EQU *
  LDA =35; BRM TCH
  BF 171
  BRM NUM; BF *+3; MRG NUMFLG; PSHK =0
  LDA =37
  BE E
  NDLBL =GNITEM
  MKND =1
171 EQU *
170 EQU *
167 EQU *
165 EQU *
162 EQU *
159 EQU *
157 EQU *
  BRU RTNO
OUTEXP  ZRO; LDA *-1; BRM CLLO
  BRM SUBOUT
  BF 172
  LDA =47; BRM TCH
  BF 173
  BRM OUTEXP
  BE =-1
  NDLBL =ALTER
  MKND =2
173 EQU *
  LDA =1; STA MFLAG
172 EQU *
  BRU RTNO
SUBOUT  ZRO; LDA *-1; BRM CLLO
  BRM OUTT
  BF 175
  BRM REST
  BF 176
  NDLBL =CONCAT
  MKND =2
176 EQU *
  LDA =1; STA MFLAG
  BRU 177
174 EQU *
  BRM REST
177 EQU *
  BRU RTNO
REST  ZRO; LDA *-1; BRM CLLO
  BRM OUTT
  BF 179
  BRM REST
  BF 180
  NDLBL =OER
  MKND =2
180 EQU *
  LDA =1; STA MFLAG
  BRU 181
178 EQU *
  BRM GEN
  BF 182
  BRM REST
  BF 183
  NDLBL =DO
  MKND =2
183 EQU *
  LDA =1; STA MFLAG
182 EQU *
181 EQU *
  BRU RTNO
OUTT  ZRO; LDA *-1; BRM CLLO
  BRM ID; BF 184; MRG IDFLG; PSHK =0
  LDA =91; BRM TCH
  LDA =39
  BE E
  BRM ARGLST
  BE =-1
  LDA =93; BRM TCH
  LDA =40
  BE E
  NDLBL =OUTCLL
  MKND =2
  BRU 185
184 EQU *
  LDA =40; BRM TCH
  BF 187
  BRM OUTEXP
  BE =-1
  LDA =41; BRM TCH
  LDA =41
  BE E
  BRU 188
186 EQU *
  BRM NSIMP1
  BF 189
  LDA =58; BRM TCH
  BF 191
  LDA =83; BRM TCH
  BF 193
  NDLBL =OS
  BRU 194
192 EQU *
  LDA =76; BRM TCH
  BF 196
  NDLBL =OL
  BRU 197
195 EQU *
  LDA =78; BRM TCH
  BF 199
  NDLBL =ON
  BRU 200
198 EQU *
  LDA =67; BRM TCH
  BF 201
  NDLBL =OC
201 EQU *
200 EQU *
197 EQU *
194 EQU *
  BE =-1
  MKND =0
  NDLBL =NOPT
  MKND =2
  BRU 202
190 EQU *
  LDA =1; STA MFLAG
  BF 203
  NDLBL =DOIT
  MKND =1
203 EQU *
202 EQU *
  BE =-1
189 EQU *
188 EQU *
185 EQU *
  BRU RTNO
ARGLST  ZRO; LDA *-1; BRM CLLO
  BRM ARGMNT
  BF 205
  NDLBL =ARG
  MKND =1
  LDA =44; BRM TCH
  BF 206
  BRM ARGLST
  BE =-1
  NDLBL =DO
  MKND =2
206 EQU *
  LDA =1; STA MFLAG
  BRU 207
204 EQU *
  LDA =1; STA MFLAG
  BF 208
  NDLBL =MT
  MKND =0
208 EQU *
207 EQU *
  BRU RTNO
ARGMNT  ZRO; LDA *-1; BRM CLLO
  BRM NSIMP
  BF 210
  NDLBL =ARGLD
  MKND =1
  BRU 211
209 EQU *
  LDA =35; BRM TCH
  BF 212
  BRM NUM; BF *+3; MRG NUMFLG; PSHK =0
  BE =-1
  NDLBL =GENARG
  MKND =1
212 EQU *
211 EQU *
  BRU RTNO
NSIMP1  ZRO; LDA *-1; BRM CLLO
  BRM SAV
  BRM NSIMP
  BF 213
  NDLBL =LKT
  MKND =1
213 EQU *
  BRM RSTR; BT 214
  BRM NSIMP
  BF 215
  NDLBL =LKT
  MKND =1
215 EQU *
214 EQU *
  BRU RTNO
NSIMP ZRO; LDA *-1; BRM CLLO
  LDA =42; BRM TCH
  BF 216
  BRM NUM; BF *+3; MRG NUMFLG; PSHK =0
  BE =-1
  BRM SAV
  LDA =1; STA MFLAG
  BF 217
  NDLBL =LCHASE
  MKND =1
217 EQU *
  BRM RSTR; BT 218
  LDA =1; STA MFLAG
  BF 219
  NDLBL =LCHASE
  MKND =1
219 EQU *
218 EQU *
  BE =-1
216 EQU *
  BRU RTNO
GEN1  ZRO; LDA *-1; BRM CLLO
  BRM OUT
  BT 220
  BRM COMM
220 EQU *
  BF 221
  BRM GEN1
  BF 222
  NDLBL =DO
  MKND =2
222 EQU *
  LDA =1; STA MFLAG
221 EQU *
  BRU RTNO
GEN ZRO; LDA *-1; BRM CLLO
  BRM COMM
  BT 223
  BRM GENU
  BT 224
  LDA =60; BRM TCH
  BF 226
  NDLBL =TTY
  MKND =0
  BRU 227
225 EQU *
  LDA =62; BRM TCH
  BF 228
  NDLBL =FIL
  MKND =0
228 EQU *
227 EQU *
224 EQU *
223 EQU *
  BRU RTNO
GENU  ZRO; LDA *-1; BRM CLLO
  BRM OUT
  BT 229
  LDA =46; BRM TCH
  BF 231
  BRM ID; BF *+3; MRG IDFLG; PSHK =0
  LDA =42
  BE E
  LDA =91; BRM TCH
  LDA =43
  BE E
  BRM ID; BF *+3; MRG IDFLG; PSHK =0
  BT 233
  BRM NUM; BF *+3; MRG NUMFLG; PSHK =0
233 EQU *
  BF 234
  NDLBL =LOAD
  MKND =1
  NDLBL =CALL
  MKND =2
  BRU 235
232 EQU *
  LDA =1; STA MFLAG
  BF 236
  NDLBL =CALL
  MKND =1
236 EQU *
235 EQU *
  BE =-1
  LDA =93; BRM TCH
  BE =-1
  BRU 237
230 EQU *
  LDA =35; BRM TCH
  BF 238
  BRM NUM; BF *+3; MRG NUMFLG; PSHK =0
  BE =-1
  NDLBL =GNLBL
  MKND =1
  LDA =58; BRM TCH
  BF 239
  NDLBL =DEF
  MKND =1
239 EQU *
  LDA =1; STA MFLAG
238 EQU *
237 EQU *
229 EQU *
  BRU RTNO
OUT ZRO; LDA *-1; BRM CLLO
  LDA =92; BRM TCH
  BF 242
  NDLBL =OUTCR
  BRU 243
241 EQU *
  LDA =44; BRM TCH
  BF 244
  NDLBL =OUTAB
244 EQU *
243 EQU *
  BF 245
  MKND =0
  BRU 246
240 EQU *
  BRM SR; BF 247; MRG SRFLG; PSHK =0
  NDLBL =OUTSR
  MKND =1
  BRU 248
247 EQU *
  LDA =39; BRM TCH
  BF 250
  BRM WPREP; BRM INC; LDA* IWP; MRG CHRFLG; MIN NCCP; PSHK =0
  NDLBL =OUTCH
  MKND =1
  BRU 251
249 EQU *
  BRM TST; DATA +W0; ASC '+W'
  BF 253
  NDLBL =UPWRK
  MKND =0
  NDLBL =OUTWRK
  MKND =1
  BRU 254
252 EQU *
  BRM TST; DATA -W0; ASC '-W'
  BF 256
  NDLBL =DNWRK
  MKND =0
  BRU 257
255 EQU *
  BRM TST; DATA .W0; ASC '.W'
  BF 259
  NDLBL =MT
  MKND =0
  NDLBL =OUTWRK
  MKND =1
  BRU 260
258 EQU *
  BRM TST; DATA ^W0; ASC '^W'
  BF 261
  NDLBL =MAXWRK
  MKND =0
261 EQU *
260 EQU *
257 EQU *
254 EQU *
251 EQU *
248 EQU *
246 EQU *
  BRU RTNO
E ZRO; LDA *-1; BRM CLLO
  LDA =1; STA MFLAG
  BF 262
  BRM RESET
  BE =-1
263 EQU *
  LDA =59; BRM TCH
  BT *+3; MIN NCCP; BRU 263
264 EQU *
  BRM RULE
  BF 265
BBM OUTREE; BT *+3; LDA =2; BRM CERR
265 EQU *
  BT 264; MIN MFLAG
  BE =-1
  BRM TST; DATA .END0; ASC '.END'
  LDA =99
  BE E
  BRM FINISH
  BE =-1
262 EQU *
  BRU RTNO
RESET ZRO; LDA *-1; BRM CLLO
  LDA =1; STA MFLAG
  BRU RTNO
FINISH  ZRO; LDA *-1; BRM CLLO
  LDA =1; STA MFLAG
  BRU RTNO
SETUP ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 266
  BRM TAB
  BRM LIT;  DATA NOLIST NUL,EXT;GEN OPD 101B5,1,1;BF OPD 102B5,1,10; ASC 'NOLIST NUL,EXT;GEN OPD 101B5,1,1;BF OPD 102B5,1,1'
  BRM CRLF
  BRM LIT;  DATA BT OPD 103B5,1,1;PSHN OPD 104B5,1,1;PSHK OPD 105B5,1,10; ASC 'BT OPD 103B5,1,1;PSHN OPD 104B5,1,1;PSHK OPD 105B5,1,1'
  BRM CRLF
  BRM LIT;  DATA MKND OPD 106B5,1,1;NDLBL OPD 107B5,1,1;GET OPD 110B5,1,10; ASC 'MKND OPD 106B5,1,1;NDLBL OPD 107B5,1,1;GET OPD 110B5,1,1'
  BRM CRLF
  BRM LIT;  DATA BPTR OPD 111B5,1,1;BNPTR OPD 112B5,1,1;RI1 OPD 113B5,1,10; ASC 'BPTR OPD 111B5,1,1;BNPTR OPD 112B5,1,1;RI1 OPD 113B5,1,1'
  BRM CRLF
  BRM LIT;  DATA RI2 OPD 114B5,2;FLGT OPD 115B5,1,1;BE OPD 116B5,1,10; ASC 'RI2 OPD 114B5,2;FLGT OPD 115B5,1,1;BE OPD 116B5,1,1'
  BRM CRLF
  BRM LIT;  DATA LAB OPD 117B5,1,1;CE OPD 120B5,1,1;LDKA OPD 121B5,1,10; ASC 'LAB OPD 117B5,1,1;CE OPD 120B5,1,1;LDKA OPD 121B5,1,1'
  BRM CRLF
  BRM LIT;  DATA $KSTKSZ EQU 100;$MSTKSZ EQU 130;$NSTKSZ EQU 1300;$SSTKSZ EQU 14000; ASC '$KSTKSZ EQU 100;$MSTKSZ EQU 130;$NSTKSZ EQU 1300;$SSTKSZ EQU 1400'
  BRM CRLF
  LDA KT
  GET =1
  EBPTR 267; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
267 EQU *
  BRM OUTS
266 EQU *
  BRU RTNO
BEGIN ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =3
  CLB; SKE NCNT; STB MFLAG
  BF 268
  BRM LIT;  DATA $START BRM INITL; CLA; STA WRK; STA XWRK0; ASC '$START BRM INITL; CLA; STA WRK; STA XWRK'
  BRM CRLF
  LDA KT
  GET =3
  EBPTR 269; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
269 EQU *
  BRM OUTS
  CE =1
  LDA KT
  GET =2
  EBPTR 270; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
270 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BRM RLINE; BRM 0; ASC 'BRM RLINE; BRM '
  LDA KT
  GET =1
  EBPTR 271; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
271 EQU *
  BRM OUTS
  CE =1
  BRM LIT;  DATA ; BRM FINISH0; ASC '; BRM FINISH'
  BRM CRLF
268 EQU *
  BRU RTNO
LIST  ZRO
  BRM LIT;  DATA  CLA; STA LISTFG;0; ASC ' CLA; STA LISTFG;'
  BRR LIST
OUTPT ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 272
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 273
  BF 274
  BRM TAB
  BRM LIT;  DATA ZRO; LDA *-1; BRM CLLO0; ASC 'ZRO; LDA *-1; BRM CLLO'
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 275; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
275 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BRU RTNO0; ASC 'BRU RTNO'
  BRM CRLF
274 EQU *
272 EQU *
  BRU RTNO
SIMP  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 276
  LDA KT
  GET =1
  EBPTR 277; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
277 EQU *
  BRM OUTS
  BF 278
  BRM TAB
  BRM LIT;  DATA ZRO0; ASC 'ZRO'
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 279; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
279 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BRR 0; ASC 'BRR '
  LDA KT
  GET =1
  EBPTR 280; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
280 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
278 EQU *
276 EQU *
  BRU RTNO
BALTER  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 282
  BRM TAB
  BRM LIT;  DATA BRM SAV0; ASC 'BRM SAV'
  BRM CRLF
  LDA KT
  GET =1
  EBPTR 283; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
283 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BRM RSTR0; ASC 'BRM RSTR'
  BRM CRLF
  BRU 284
281 EQU *
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 285
  BRM TAB
  BRM LIT;  DATA BRM SAV0; ASC 'BRM SAV'
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 286; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
286 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BRM RSTR; BT 0; ASC 'BRM RSTR; BT '
  GEN GNLB1
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 287; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
287 EQU *
  BRM OUTS
  CE =1
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
285 EQU *
284 EQU *
  BRU RTNO
D ZRO
  BRM TAB
  BRM LIT;  DATA EQU *0; ASC 'EQU *'
  BRM CRLF
  BRR D
ALTER ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  MIN CNT; EAX - 1,2
  RI1 =SET; BRU 289
  CLB; SKE NCNT; STB MFLAG
  RI2
289 EQU *
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 290
  LDA KT
  GET =1
  EBPTR 291; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
291 EQU *
  BRM OUTS
  BF 292
  LDA KT
  GET =2
  EBPTR 293; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
293 EQU *
  BRM OUTS
292 EQU *
  BRU 294
288 EQU *
  BRM BEGN
  RI1 =CONCAT; BRU 296
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  RI2
296 EQU *
  MIN CNT; EAX - 1,2
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 297
  LDA NSP; STA SNSP; NDLBL =PMT; CLA; STA CNT
  LDA KT; STA ME
  LDA ME
  GET =1; BPTR *+3; LDA =3; BRM CERR
  GET =1
  PSHK  =0; MIN CNT
  LAB GNLB1; MRG GENFLG
  PSHK  =0; MIN CNT
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  BF 298
  LDA KT
  GET =1; BPTR *+3; LDA =3; BRM CERR
  GET =2
  EBPTR 299; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
299 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BRU 0; ASC 'BRU '
  GEN GNLB2
  BRM CRLF
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  CE =1
  LDA KT
  GET =2
  EBPTR 300; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
300 EQU *
  BRM OUTS
  CE =1
  GEN GNLB2
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  CE =1
  BRM CRLF
298 EQU *
  BRU 301
295 EQU *
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 302
  LDA KT
  GET =1
  EBPTR 303; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
303 EQU *
  BRM OUTS
  BF 304
  BRM TAB
  BRM LIT;  DATA BT 0; ASC 'BT '
  GEN GNLB1
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 305; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
305 EQU *
  BRM OUTS
  CE =1
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
304 EQU *
302 EQU *
301 EQU *
294 EQU *
  BRU RTNO
PMT ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  RI1 =PRIM; BRU 307
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  RI2
307 EQU *
  MIN CNT; EAX - 1,2
  FLGT GENFLG; ETR= 77777B; STA GNLB1
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 308
  BRM TAB
  BRM LIT;  DATA BRM 0; ASC 'BRM '
  LDA KT
  GET =1; BPTR *+3; LDA =3; BRM CERR
  GET =1
  BNPTR *+3; LDA =4; BRM 309
  CE =1
  BRM LIT;  DATA ; BF 0; ASC '; BF '
  GEN GNLB1
  BRM LIT;  DATA ; MRG 0; ASC '; MRG '
  LDA KT
  GET =1; BPTR *+3; LDA =3; BRM CERR
  GET =1
  BNPTR *+3; LDA =4; BRM 310
  CE =1
  BRM LIT;  DATA FLG; PSHK =00; ASC 'FLG; PSHK =0'
  BRM CRLF
  BRU 311
306 EQU *
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 312
  LDA KT
  GET =2
  EBPTR 313; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
313 EQU *
  BRM OUTS
  BF 314
  BRM TAB
  BRM LIT;  DATA BF 0; ASC 'BF '
  GEN GNLB1
  BRM CRLF
314 EQU *
312 EQU *
311 EQU *
  BRU RTNO
ER  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  RI1 =ALTER; BRU 316
  MIN CNT; EAX - 1,2
  RI1 =SET; BRU 317
  CLB; SKE NCNT; STB MFLAG
  RI2
317 EQU *
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  RI2
316 EQU *
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 318
  LDA KT
  GET =1
  EBPTR 319; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
319 EQU *
  BRM OUTS
  BRU 320
315 EQU *
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 321
  LDA KT
  GET =1
  EBPTR 322; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
322 EQU *
  BRM OUTS
  BF 323
  BRM TAB
  BRM LIT;  DATA BE =-10; ASC 'BE =-1'
  BRM CRLF
323 EQU *
321 EQU *
320 EQU *
  BRU RTNO
DO  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 324
  LDA KT
  GET =1
  EBPTR 325; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
325 EQU *
  BRM OUTS
  BF 326
  LDA KT
  GET =2
  EBPTR 327; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
327 EQU *
  BRM OUTS
326 EQU *
324 EQU *
  BRU RTNO
CONCAT  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 328
  LDA KT
  GET =1
  EBPTR 329; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
329 EQU *
  BRM OUTS
  BF 330
  BRM TAB
  BRM LIT;  DATA BF 0; ASC 'BF '
  GEN GNLB1
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 331; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
331 EQU *
  BRM OUTS
  CE =1
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
330 EQU *
328 EQU *
  BRU RTNO
LOAD  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  FLGT NUMFLG
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 333
  BRM TAB
  BRM LIT;  DATA LDA =0; ASC 'LDA ='
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 334
  CE =1
  BRM CRLF
  BRU 335
332 EQU *
  BRM BEGN
  FLGT IDFLG
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 336
  BRM TAB
  BRM LIT;  DATA LDA 0; ASC 'LDA '
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 337
  CE =1
  BRM CRLF
336 EQU *
335 EQU *
  BRU RTNO
CALL  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 339
  BRM TAB
  BRM LIT;  DATA BRM 0; ASC 'BRM '
  LDA KT
  GET =1
  EBPTR 340; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
340 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
  BRU 341
338 EQU *
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 342
  LDA KT
  GET =2
  EBPTR 343; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
343 EQU *
  BRM OUTS
  BF 344
  BRM TAB
  BRM LIT;  DATA BRM 0; ASC 'BRM '
  LDA KT
  GET =1
  EBPTR 345; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
345 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
344 EQU *
342 EQU *
341 EQU *
  BRU RTNO
MT  ZRO
  LDA =1; STA MFLAG
  BRR MT
CLA ZRO
  BRM LIT;  DATA CLA0; ASC 'CLA'
  BRR CLA
ZRO ZRO
  BRM LIT;  DATA 00; ASC '0'
  BRR ZRO
ERCOD ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =3
  CLB; SKE NCNT; STB MFLAG
  BF 346
  LDA KT
  GET =1
  EBPTR 347; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
347 EQU *
  BRM OUTS
  BF 348
  LDA KT
  GET =2
  EBPTR 349; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
349 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BE 0; ASC 'BE '
  LDA KT
  GET =3
  EBPTR 350; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
350 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
348 EQU *
346 EQU *
  BRU RTNO
NDLB  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 351
  BRM TAB
  BRM LIT;  DATA NDLBL =0; ASC 'NDLBL ='
  LDA KT
  GET =1
  EBPTR 352; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
352 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
351 EQU *
  BRU RTNO
MKNODE  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 353
  BRM TAB
  BRM LIT;  DATA MKND =0; ASC 'MKND ='
  LDA KT
  GET =1
  EBPTR 354; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
354 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
353 EQU *
  BRU RTNO
ARB ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  RI1 =ZRO; BRU 356
  CLB; SKE NCNT; STB MFLAG
  RI2
356 EQU *
  MIN CNT; EAX - 1,2
  RI1 =MT; BRU 357
  CLB; SKE NCNT; STB MFLAG
  RI2
357 EQU *
  MIN CNT; EAX - 1,2
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 358
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  CE =1
  LDA KT
  GET =3
  EBPTR 359; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
359 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BT 0; ASC 'BT '
  GEN GNLB1
  BRM LIT;  DATA ; MIN MFLAG0; ASC '; MIN MFLAG'
  BRM CRLF
  BRU 360
355 EQU *
  BRM BEGN
  FLGT NUMFLG
  MIN CNT; EAX - 1,2
  RI1 =MT; BRU 362
  CLB; SKE NCNT; STB MFLAG
  RI2
362 EQU *
  MIN CNT; EAX - 1,2
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 363
  LDA NSP; STA SNSP; NDLBL =ARB1; CLA; STA CNT
  LDA KT; STA ME
  LDA ME
  GET =1
  PSHK  =0; MIN CNT
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  BF 364
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  CE =1
  LDA KT
  GET =3
  EBPTR 365; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
365 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA SKR* MSP; BT 0; ASC 'SKR* MSP; BT '
  GEN GNLB1
  BRM LIT;  DATA ; SKN* MSP; BRU *+3; BT 0; ASC '; SKN* MSP; BRU *+3; BT '
  GEN GNLB1
  BRM LIT;  DATA ; MIN MFLAG0; ASC '; MIN MFLAG'
  BRM CRLF
  LDA NSP; STA SNSP; NDLBL =ARB3; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
364 EQU *
  BRU 366
361 EQU *
  BRM BEGN
  MIN CNT; EAX - 1,2
  FLGT NUMFLG
  MIN CNT; EAX - 1,2
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 367
  LDA NSP; STA SNSP; NDLBL =ARB1; CLA; STA CNT
  LDA KT; STA ME
  LDA ME
  GET =2
  PSHK  =0; MIN CNT
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  BF 368
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  CE =1
  LDA KT
  GET =3
  EBPTR 369; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
369 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA SKR* MSP; BT 0; ASC 'SKR* MSP; BT '
  GEN GNLB1
  BRM LIT;  DATA ; SKN* MSP0; ASC '; SKN* MSP'
  BRM CRLF
  LDA NSP; STA SNSP; NDLBL =ARB2; CLA; STA CNT
  LDA KT; STA ME
  LDA ME
  GET =1
  PSHK  =0; MIN CNT
  LDA ME
  GET =2
  PSHK  =0; MIN CNT
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
368 EQU *
367 EQU *
366 EQU *
360 EQU *
  BRU RTNO
ARB1  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 370
  BRM TAB
  BRM LIT;  DATA BRM SAV; LDA =0; ASC 'BRM SAV; LDA ='
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 371
  CE =1
  BRM LIT;  DATA +1; MIN MSP; STA* MSP0; ASC '+1; MIN MSP; STA* MSP'
  BRM CRLF
370 EQU *
  BRU RTNO
ARB2  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  MIN CNT; EAX - 1,2
  FLGT NUMFLG
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 373
  BRM TAB
  BRM LIT;  DATA BRM *+4; CLA; STA MFLAG; BRU *+4; LDA* MSP; SKG =0; ASC 'BRM *+4; CLA; STA MFLAG; BRU *+4; LDA* MSP; SKG ='
  LDA KT
  GET =2
  EBPTR 374; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
374 EQU *
  BRM OUTS
  CE =1
  BRM LIT;  DATA -0; ASC '-'
  LDA KT
  GET =1
  EBPTR 375; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
375 EQU *
  BRM OUTS
  CE =1
  BRM LIT;  DATA ; MIN MFLAG0; ASC '; MIN MFLAG'
  BRM CRLF
  LDA NSP; STA SNSP; NDLBL =ARB3; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  BRU 376
372 EQU *
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 377
  BRM TAB
  BRM LIT;  DATA BRU *+3; CLA; STA MFLAG0; ASC 'BRU *+3; CLA; STA MFLAG'
  BRM CRLF
  LDA NSP; STA SNSP; NDLBL =ARB3; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
377 EQU *
376 EQU *
  BRU RTNO
ARB3  ZRO
  BRM TAB
  BRM LIT;  DATA LDA =-1; ADM MSP; BRM RSTR0; ASC 'LDA =-1; ADM MSP; BRM RSTR'
  BRM CRLF
  BRR ARB3
GCHR  ZRO
  BRM TAB
  BRM LIT;  DATA BRM WPREP; BRM INC; LDA* IWP; MRG CHRFLG; MIN NCCP; PSHK =00; ASC 'BRM WPREP; BRM INC; LDA* IWP; MRG CHRFLG; MIN NCCP; PSHK =0'
  BRM CRLF
  BRR GCHR
GO  ZRO
  BRM LIT;  DATA BBM OUTREE; BT *+3; LDA =2; BRM CERR0; ASC 'BBM OUTREE; BT *+3; LDA =2; BRM CERR'
  BRM CRLF
  BRR GO
SET ZRO
  BRM TAB
  BRM LIT;  DATA LDA =1; STA MFLAG0; ASC 'LDA =1; STA MFLAG'
  BRM CRLF
  BRR SET
TTY ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 379
  LDA NSP; STA SNSP; NDLBL =TTY; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  BF 380
  LDA KT
  GET =1
  EBPTR 381; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
381 EQU *
  BRM OUTS
  CE =1
  LDA NSP; STA SNSP; NDLBL =FIL; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
380 EQU *
  BRU 382
378 EQU *
  BRM BEGN
  CLB; SKE NCNT; STB MFLAG
  BF 383
  BRM TAB
  BRM LIT;  DATA LDA =1; STA FNUMO0; ASC 'LDA =1; STA FNUMO'
  BRM CRLF
  LDA NSP; STA SNSP; NDLBL =XCHCH; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
383 EQU *
382 EQU *
  BRU RTNO
FIL ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  CLB; SKE NCNT; STB MFLAG
  BF 384
  BRM TAB
  BRM LIT;  DATA LDA XFNUMO; STA FNUMO0; ASC 'LDA XFNUMO; STA FNUMO'
  BRM CRLF
384 EQU *
  BRU RTNO
XCHCH ZRO
  BRM TAB
  BRM LIT;  DATA LDA TCHNO; XMA CHNO; STA TCHNO0; ASC 'LDA TCHNO; XMA CHNO; STA TCHNO'
  BRM CRLF
  BRR XCHCH
STRING  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 385
  BRM LIT;  DATA  DATA 0; ASC ' DATA '
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 386
  CE =1
  BRM LIT;  DATA ; ASC 0; ASC '; ASC '
  LDA =39; CIO FNUMO; MIN CHNO
  LDA KT
  GET =1
  EBPTR 387; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
387 EQU *
  BRM OUTS
  CE =1
  LDA =39; CIO FNUMO; MIN CHNO
  BRM CRLF
385 EQU *
  BRU RTNO
OSET  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 388
  BRM TAB
  BRM LIT;  DATA BRM BEGN0; ASC 'BRM BEGN'
  BRM CRLF
  LDA KT
  GET =1
  EBPTR 389; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
389 EQU *
  BRM OUTS
388 EQU *
  BRU RTNO
CNTCK ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 390
  LDA KT
  GET =1
  EBPTR 391; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
391 EQU *
  BRM OUTS
  BF 392
  BRM TAB
  BRM LIT;  DATA CLB; SKE NCNT; STB MFLAG0; ASC 'CLB; SKE NCNT; STB MFLAG'
  BRM CRLF
392 EQU *
390 EQU *
  BRU RTNO
ONE ZRO
  BRM TAB
  BRM LIT;  DATA LDA =10; ASC 'LDA =1'
  BRM CRLF
  BRR ONE
TWO ZRO
  BRM TAB
  BRM LIT;  DATA LDA =20; ASC 'LDA =2'
  BRM CRLF
  BRR TWO
THRE  ZRO
  BRM TAB
  BRM LIT;  DATA LDA =30; ASC 'LDA =3'
  BRM CRLF
  BRR THRE
ITMSTR  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 393
  LDA KT
  GET =1
  EBPTR 394; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
394 EQU *
  BRM OUTS
  BF 395
  BRM TAB
  BRM LIT;  DATA MIN CNT; EAX - 1,20; ASC 'MIN CNT; EAX - 1,2'
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 396; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
396 EQU *
  BRM OUTS
395 EQU *
393 EQU *
  BRU RTNO
LITEM ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 397
  LDA KT
  GET =1
  EBPTR 398; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
398 EQU *
  BRM OUTS
  BF 399
  BRM TAB
  BRM LIT;  DATA MIN CNT; LDA CNT0; ASC 'MIN CNT; LDA CNT'
  BRM CRLF
399 EQU *
397 EQU *
  BRU RTNO
RITEM ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 400
  BRM TAB
  BRM LIT;  DATA RI1 =0; ASC 'RI1 ='
  LDA KT
  GET =1
  EBPTR 401; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
401 EQU *
  BRM OUTS
  CE =1
  BRM LIT;  DATA ; BRU 0; ASC '; BRU '
  GEN GNLB1
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 402; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
402 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA RI20; ASC 'RI2'
  BRM CRLF
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
400 EQU *
  BRU RTNO
OER ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 403
  LDA KT
  GET =1
  EBPTR 404; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
404 EQU *
  BRM OUTS
  BF 405
  BRM TAB
  BRM LIT;  DATA CE =10; ASC 'CE =1'
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 406; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
406 EQU *
  BRM OUTS
405 EQU *
403 EQU *
  BRU RTNO
OUTCLL  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 407
  BRM TAB
  BRM LIT;  DATA LDA NSP; STA SNSP; NDLBL =0; ASC 'LDA NSP; STA SNSP; NDLBL ='
  LDA KT
  GET =1
  EBPTR 408; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
408 EQU *
  BRM OUTS
  CE =1
  BRM LIT;  DATA ; CLA; STA CNT0; ASC '; CLA; STA CNT'
  BRM CRLF
  BRM TAB
  BRM LIT;  DATA LDA KT; STA ME0; ASC 'LDA KT; STA ME'
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 409; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
409 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK0; ASC 'MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK'
  BRM CRLF
  BRM TAB
  BRM LIT;  DATA LDA* NSP; STA NSP0; ASC 'LDA* NSP; STA NSP'
  BRM CRLF
407 EQU *
  BRU RTNO
ARGLD ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 410
  BRM TAB
  BRM LIT;  DATA LDA ME0; ASC 'LDA ME'
  BRM CRLF
  LDA KT
  GET =1
  EBPTR 411; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
411 EQU *
  BRM OUTS
410 EQU *
  BRU RTNO
ARG ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 412
  LDA KT
  GET =1
  EBPTR 413; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
413 EQU *
  BRM OUTS
  BF 414
  BRM TAB
  BRM LIT;  DATA PSHK  =0; MIN CNT0; ASC 'PSHK  =0; MIN CNT'
  BRM CRLF
414 EQU *
412 EQU *
  BRU RTNO
CHASE ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 415
  BRM TAB
  BRM LIT;  DATA GET =0; ASC 'GET ='
  LDA KT
  GET =1
  EBPTR 416; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
416 EQU *
  BRM OUTS
  CE =1
  BRM LIT;  DATA ; BPTR *+3; LDA =3; BRM CERR0; ASC '; BPTR *+3; LDA =3; BRM CERR'
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 417; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
417 EQU *
  BRM OUTS
415 EQU *
  BRU RTNO
LCHASE  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 418
  BRM TAB
  BRM LIT;  DATA GET =0; ASC 'GET ='
  LDA KT
  GET =1
  EBPTR 419; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
419 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
418 EQU *
  BRU RTNO
DOIT  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 420
  LDA KT
  GET =1
  EBPTR 421; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
421 EQU *
  BRM OUTS
  BF 422
  BRM TAB
  BRM LIT;  DATA EBPTR 0; ASC 'EBPTR '
  GEN GNLB1
  BRM LIT;  DATA ; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+20; ASC '; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2'
  BRM CRLF
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  CE =1
  BRM TAB
  BRM LIT;  DATA BRM OUTS0; ASC 'BRM OUTS'
  BRM CRLF
422 EQU *
420 EQU *
  BRU RTNO
NOPT  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 423
  LDA KT
  GET =1
  EBPTR 424; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
424 EQU *
  BRM OUTS
  BF 425
  BRM TAB
  BRM LIT;  DATA BNPTR *+3; LDA =4; BRM 0; ASC 'BNPTR *+3; LDA =4; BRM '
  GEN GNLB1
  BRM CRLF
425 EQU *
423 EQU *
  BRU RTNO
SCAN  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 426
  GEN GNLB1
  LDA NSP; STA SNSP; NDLBL =D; CLA; STA CNT
  LDA KT; STA ME
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
  CE =1
  LDA KT
  GET =1
  EBPTR 427; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
427 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BT *+3; MIN NCCP; BRU 0; ASC 'BT *+3; MIN NCCP; BRU '
  GEN GNLB1
  BRM CRLF
426 EQU *
  BRU RTNO
PRIM  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 428
  BRM TAB
  BRM LIT;  DATA BRM 0; ASC 'BRM '
  LDA KT
  GET =1
  EBPTR 429; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
429 EQU *
  BRM OUTS
  CE =1
  BRM LIT;  DATA ; BF *+3; MRG 0; ASC '; BF *+3; MRG '
  LDA KT
  GET =1
  EBPTR 430; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
430 EQU *
  BRM OUTS
  CE =1
  BRM LIT;  DATA FLG; PSHK =00; ASC 'FLG; PSHK =0'
  BRM CRLF
428 EQU *
  BRU RTNO
STST  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 431
  BRM TAB
  BRM LIT;  DATA BRM TST;0; ASC 'BRM TST;'
  LDA NSP; STA SNSP; NDLBL =STRING; CLA; STA CNT
  LDA KT; STA ME
  LDA ME
  GET =1
  PSHK  =0; MIN CNT
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
431 EQU *
  BRU RTNO
CTST  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 432
  BRM TAB
  BRM LIT;  DATA LDA =0; ASC 'LDA ='
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 433
  CE =1
  BRM LIT;  DATA ; BRM TCH0; ASC '; BRM TCH'
  BRM CRLF
432 EQU *
  BRU RTNO
OS  ZRO
  BRM LIT;  DATA  BRM OUTS0; ASC ' BRM OUTS'
  BRM CRLF
  BRR OS
ON  ZRO
  BRM LIT;  DATA  ETR =77777B; BRM OUTN0; ASC ' ETR =77777B; BRM OUTN'
  BRM CRLF
  BRR ON
OL  ZRO
  BRM LIT;  DATA  CAX; LDA 0,2; BRM DUTN0; ASC ' CAX; LDA 0,2; BRM DUTN'
  BRM CRLF
  BRR OL
OC  ZRO
  BRM LIT;  DATA  ETR =377B,; CIO FNUMO; MIN CHNO0; ASC ' ETR =377B,; CIO FNUMO; MIN CHNO'
  BRM CRLF
  BRR OC
GNLBL ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 434
  BRM TAB
  BRM LIT;  DATA GEN GNLB0; ASC 'GEN GNLB'
  LDA KT
  GET =1
  EBPTR 435; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
435 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
434 EQU *
  BRU RTNO
DEF ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 436
  LDA KT
  GET =1
  EBPTR 437; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
437 EQU *
  BRM OUTS
  BF 438
  BRM TAB
  BRM LIT;  DATA BRM LIT; DATA 6; ASC 0; ASC 'BRM LIT; DATA 6; ASC '
  LDA =39; CIO FNUMO; MIN CHNO
  BRM LIT;  DATA  EQU *0; ASC ' EQU *'
  LDA =39; CIO FNUMO; MIN CHNO
  BRM CRLF
438 EQU *
436 EQU *
  BRU RTNO
OUTCR ZRO
  BRM TAB
  BRM LIT;  DATA BRM CRLF0; ASC 'BRM CRLF'
  BRM CRLF
  BRR OUTCR
OUTAB ZRO
  BRM TAB
  BRM LIT;  DATA BRM TAB0; ASC 'BRM TAB'
  BRM CRLF
  BRR OUTAB
OUTSR ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 439
  BRM TAB
  BRM LIT;  DATA BRM LIT; 0; ASC 'BRM LIT; '
  LDA NSP; STA SNSP; NDLBL =STRING; CLA; STA CNT
  LDA KT; STA ME
  LDA ME
  GET =1
  PSHK  =0; MIN CNT
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
439 EQU *
  BRU RTNO
OUTCH ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 440
  BRM TAB
  BRM LIT;  DATA LDA =0; ASC 'LDA ='
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 441
  CE =1
  BRM LIT;  DATA ; CIO FNUMO; MIN CHNO0; ASC '; CIO FNUMO; MIN CHNO'
  BRM CRLF
440 EQU *
  BRU RTNO
ENDN  ZRO
  BRM LIT;  DATA SSTOP DATA SS+SSTKSZ-5; $SS BSS SSTKSZ0; ASC 'SSTOP DATA SS+SSTKSZ-5; $SS BSS SSTKSZ'
  BRM CRLF
  BRM LIT;  DATA MSP DATA MSTK; SMSPT DATA MSTK+MSTKSZ-5;$MSTK BSS MSTKSZ0; ASC 'MSP DATA MSTK; SMSPT DATA MSTK+MSTKSZ-5;$MSTK BSS MSTKSZ'
  BRM CRLF
  BRM LIT;  DATA NSP DATA NSTK; SNSPT DATA NSTK+NSTKSZ-5;$NSTK BSS NSTKSZ0; ASC 'NSP DATA NSTK; SNSPT DATA NSTK+NSTKSZ-5;$NSTK BSS NSTKSZ'
  BRM CRLF
  BRM LIT;  DATA KSP DATA KSTK; SKSPT DATA KSTK+KSTKSZ-5;$KSTK BSS KSTKSZ0; ASC 'KSP DATA KSTK; SKSPT DATA KSTK+KSTKSZ-5;$KSTK BSS KSTKSZ'
  BRM CRLF
  BRM LIT;  DATA WRK  BSS 1;XWRK BSS 1; END0; ASC 'WRK  BSS 1;XWRK BSS 1; END'
  BRM CRLF
  BRR ENDN
SAVG  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 442
  BRM TAB
  BRM LIT;  DATA BRM SAVGN0; ASC 'BRM SAVGN'
  BRM CRLF
  LDA KT
  GET =1
  EBPTR 443; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
443 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA BRMRSTGN0; ASC 'BRMRSTGN'
  BRM CRLF
442 EQU *
  BRU RTNO
IMED  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 444
  BRM TAB
  LDA KT
  GET =1
  EBPTR 445; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
445 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
444 EQU *
  BRU RTNO
NITEM ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 446
  BRM TAB
  BRM LIT;  DATA STX INDX; LDA KT0; ASC 'STX INDX; LDA KT'
  BRM CRLF
  LDA KT
  GET =1
  EBPTR 447; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
447 EQU *
  BRM OUTS
  CE =1
  BRM LIT;  DATA CLB; LDX INDX; SKE 0,2; STB MFLAG0; ASC 'CLB; LDX INDX; SKE 0,2; STB MFLAG'
  BRM CRLF
446 EQU *
  BRU RTNO
FITEM ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 448
  BRM TAB
  BRM LIT;  DATA FLGT 0; ASC 'FLGT '
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 449
  CE =1
  BRM LIT;  DATA FLG0; ASC 'FLG'
  BRM CRLF
448 EQU *
  BRU RTNO
TTST  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 450
  BRM TAB
  BRM LIT;  DATA BRM SSTEST;0; ASC 'BRM SSTEST;'
  LDA NSP; STA SNSP; NDLBL =STRING; CLA; STA CNT
  LDA KT; STA ME
  LDA ME
  GET =1
  PSHK  =0; MIN CNT
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
450 EQU *
  BRU RTNO
CHTST ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 451
  BRM TAB
  BRM LIT;  DATA CLB; LDA =0; ASC 'CLB; LDA ='
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 452
  CE =1
  BRM LIT;  DATA ; MRG CHRFLG; SKE 0,2; STB MFLAG0; ASC '; MRG CHRFLG; SKE 0,2; STB MFLAG'
  BRM CRLF
451 EQU *
  BRU RTNO
GNITEM  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 453
  BRM TAB
  BRM LIT;  DATA FLGT GENFLG; ETR= 77777B; STA GNLB0; ASC 'FLGT GENFLG; ETR= 77777B; STA GNLB'
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 454
  CE =1
  BRM CRLF
453 EQU *
  BRU RTNO
GENARG  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 455
  BRM TAB
  BRM LIT;  DATA LAB GNLB0; ASC 'LAB GNLB'
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 456
  CE =1
  BRM LIT;  DATA ; MRG GENFLG0; ASC '; MRG GENFLG'
  BRM CRLF
455 EQU *
  BRU RTNO
NTST  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 457
  BRM TAB
  BRM LIT;  DATA LDA NCCP; STA SNCCP0; ASC 'LDA NCCP; STA SNCCP'
  BRM CRLF
  LDA KT
  GET =1
  EBPTR 458; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
458 EQU *
  BRM OUTS
  CE =1
  BRM TAB
  BRM LIT;  DATA LDA =1; SKR MFLAG; BRU *+2; STA MFLAG; LDA SNCCP; STA NCCP0; ASC 'LDA =1; SKR MFLAG; BRU *+2; STA MFLAG; LDA SNCCP; STA NCCP'
  BRM CRLF
457 EQU *
  BRU RTNO
NCHR  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 459
  BRM TAB
  BRM LIT;  DATA LDA =0; ASC 'LDA ='
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 460
  CE =1
  BRM LIT;  DATA ; BRM TCH0; ASC '; BRM TCH'
  BRM CRLF
459 EQU *
  BRU RTNO
NSR ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 461
  BRM TAB
  BRM LIT;  DATA BRM TST; 0; ASC 'BRM TST; '
  LDA NSP; STA SNSP; NDLBL =STRING; CLA; STA CNT
  LDA KT; STA ME
  LDA ME
  GET =1
  PSHK  =0; MIN CNT
  MKND CNT; PSHN SNSP; LDX KT; BRM* 0,2; BRM POPK
  LDA* NSP; STA NSP
461 EQU *
  BRU RTNO
UP  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  BRM SSTEST; DATA 10; ASC '1'
  MIN CNT; EAX - 1,2
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 463
  BRM TAB
  BRM LIT;  DATA LDA* KSP0; ASC 'LDA* KSP'
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 464; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
464 EQU *
  BRM OUTS
  BRU 465
462 EQU *
  BRM BEGN
  LDA =2
  CLB; SKE NCNT; STB MFLAG
  BF 466
  BRM TAB
  BRM LIT;  DATA LDX KSP; LDA 1-0; ASC 'LDX KSP; LDA 1-'
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 467
  CE =1
  BRM LIT;  DATA ,20; ASC ',2'
  BRM CRLF
  LDA KT
  GET =2
  EBPTR 468; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
468 EQU *
  BRM OUTS
466 EQU *
465 EQU *
  BRU RTNO
LKT ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 469
  BRM TAB
  BRM LIT;  DATA LDA KT0; ASC 'LDA KT'
  BRM CRLF
  LDA KT
  GET =1
  EBPTR 470; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
470 EQU *
  BRM OUTS
469 EQU *
  BRU RTNO
UPWRK ZRO
  BRM TAB
  BRM LIT;  DATA MIN WRK; LDA WRK; SKG XWRK; LDA XWRK; STA XWRK0; ASC 'MIN WRK; LDA WRK; SKG XWRK; LDA XWRK; STA XWRK'
  BRM CRLF
  BRR UPWRK
DNWRK ZRO
  BRM TAB
  BRM LIT;  DATA LDA =-1; ADM WRK0; ASC 'LDA =-1; ADM WRK'
  BRM CRLF
  BRR DNWRK
OUTWRK  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 471
  LDA KT
  GET =1
  EBPTR 472; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
472 EQU *
  BRM OUTS
  BF 473
  BRM TAB
  BRM LIT;  DATA LDA WRK; BRM OUTN0; ASC 'LDA WRK; BRM OUTN'
  BRM CRLF
473 EQU *
471 EQU *
  BRU RTNO
MAXWRK  ZRO
  BRM TAB
  BRM LIT;  DATA LDA XWRK; BRM OUTN0; ASC 'LDA XWRK; BRM OUTN'
  BRM CRLF
  BRR MAXWRK
SIZS  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  FLGT CHRFLG
  MIN CNT; EAX - 1,2
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 474
  LDA KT
  GET =1
  BNPTR *+3; LDA =4; BRM 475
  BF 476
  BRM LIT;  DATA STKSZ EQU 0; ASC 'STKSZ EQU '
  LDA KT
  GET =2
  BNPTR *+3; LDA =4; BRM 477
  CE =1
  BRM CRLF
476 EQU *
474 EQU *
  BRU RTNO
KPOPK ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 478
  BRM TAB
  BRM LIT;  DATA MIN MSP; LDA KT; STA* MSP; MIN MSP; LDA KSP; STA* MSP0; ASC 'MIN MSP; LDA KT; STA* MSP; MIN MSP; LDA KSP; STA* MSP'
  LDA KT
  GET =1
  EBPTR 479; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
479 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
  BRM TAB
  BRM LIT;  DATA LDX MSP; LDA 0,2; STA KSP; LDA -1,2; STA KT; LDA =-2; AIX MSP0; ASC 'LDX MSP; LDA 0,2; STA KSP; LDA -1,2; STA KT; LDA =-2; AIX MSP'
  BRM CRLF
478 EQU *
  BRU RTNO
PAROUT  ZRO; LDA *-1; BRM CLLO
  BRM BEGN
  RI1 =ZRO; BRU 481
  CLB; SKE NCNT; STB MFLAG
  RI2
481 EQU *
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 482
  BRM TAB
  BRM LIT;  DATA LDA KT0; ASC 'LDA KT'
  BRM CRLF
  BRU 483
480 EQU *
  BRM BEGN
  BRM SSTEST; DATA 00; ASC '0'
  MIN CNT; LDA CNT
  CLB; SKE NCNT; STB MFLAG
  BF 485
  BRM TAB
  BRM LIT;  DATA LDA KT0; ASC 'LDA KT'
  BRM CRLF
  BRU 486
484 EQU *
  BRM BEGN
  LDA =1
  CLB; SKE NCNT; STB MFLAG
  BF 487
  BRM TAB
  BRM LIT;  DATA LDKA =0; ASC 'LDKA ='
  LDA KT
  GET =1
  EBPTR 488; CAX; PSHK =0; BRM* 0,2; BRM POPK; BRU *+2
488 EQU *
  BRM OUTS
  CE =1
  BRM CRLF
487 EQU *
486 EQU *
483 EQU *
  BRU RTNO
SSTOP DATA SS+SSTKSZ-5; $SS BSS SSTKSZ
MSP DATA MSTK; SMSPT DATA MSTK+MSTKSZ-5;$MSTK BSS MSTKSZ
NSP DATA NSTK; SNSPT DATA NSTK+NSTKSZ-5;$NSTK BSS NSTKSZ
KSP DATA KSTK; SKSPT DATA KSTK+KSTKSZ-5;$KSTK BSS KSTKSZ
WRK  BSS 1;XWRK BSS 1; END
